<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Miguel MZ - Research</title>
    <link rel="shortcut icon" href="../images/icon.png">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/bootstrap4-neon-glow.min.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel='stylesheet' href='//cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>

 <div class="navbar-dark text-white">
    <div class="container">
      <nav class="navbar px-0 navbar-expand-lg navbar-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a href="../index.html" class="pl-md-0 p-3 text-light" style="font-family:courier,arial,helvética"> > Start</a>
            <a href="../whoami.html" class="p-3 text-decoration-none text-light" style="font-family:courier,arial,helvética">> Whoami</a>
          </div>
        </div>
      </nav>
    </div>
  </div>

<div class="jumbotron bg-transparent mb-0 radius-0">
  <div class="container">
      <div class="row">
        <div class="">
          <h1 class="display-1" style="font-family:courier,arial,helvética">kd❯ <span class="vim-caret" style="font-family:courier,arial,helvética">g</span></h1>
          <div class="lead mb-3 text-mono text-success" style="font-size: 25px;font-family:courier,arial,helvética">fffff803'00000000 EB FE jmp short loc_HackinG</div>
          <p class="mt-5 text-grey text-spacey">
            <h1 style="font-family:courier,arial,helvética">~ ./priv</h1><br><br>
            <table border="0" width="100%">
        				<tr>
        					<td style="font-size: 30px; color: aliceblue;font-family:courier,arial,helvética;">
        						Micro Focus Solutions Business Manager - CVE-2019–3477
        					</td>
        				</tr>
                <tr>
                  <td>
                    <hr>
                  </td>
                </tr>
        				<tr>
        					<td align="justify" style="font-size: 20px; color: aliceblue;font-family:courier,arial,helvética;">
                    <p>
Este sera un breve post el cual explicare algo muy trivial que se puede encontrar en muchas plataformas y sistemas web como son las Re-direcciones, esto nos permite enviar a un usuario a dominios que controlamos con código malicioso (phishing).<br><br>
Bueno esto se pueden encontrar fácilmente en portales cautivos, re-dirección por autorizaciones, to_back, url, o en variables callback que a veces tenemos unos Jquery por ahí, etc. eso dependerá del sitio y sus variables.<br><br>

Un ejemplo seria así:<br><br>

https://www.domain.com/login/to_back=https://www.domain.com<br><br>

Modificada:<br><br>

https://www.domain.com/login/to_back=https://www.exploiting.cl<br><br>

Bueno para ir resumiendo la misma empresa que ofrece el sistema SBM (Solutions Business Manager) tiene la vulnerabilidad, si es así podríamos pensar que la versión mas actual tiene este ¡¡¡ BuG !!!.<br><br>

<center><img src="https://miro.medium.com/max/1400/1*Dg21oja7Hd1CUFw3KsWgeg.png" width="500px"></center><br><br>

La vulnerabilidad se encuentra en una condición window.location.hash la cual toma el valor de un hash fsid=0bf9cee3146742c096a42b50247e65bb y la variable continue=https://www.exploiting.cl, donde es movida a la variable newActionURL para que luego sea cargada como atributo al form $(“#LoginForm”).attr(“action”, newActionURL).<br><br>

Ahora para que se produzca la vulnerabilidad debemos quitar el hash de la variable fsid.<br><br>

— — Login From — —<br><br>

<center><img src="https://miro.medium.com/max/1400/1*MhV_56w_-T5EQzEtsEmy-w.png" width="800px"></center><br><br>

— — PostRedirect Form — —<br><br>

<center><img src="https://miro.medium.com/max/1400/1*Y7vdimxIN5xi4-WeI-BzTw.png" width="800px"></center><br><br>

Ahora se viene lo mejor creo yo. Si Micro Focus que es la empresa que ofrece este servicio vulnerable a Open Redirect y que además lo utilizan ellos mismos, podemos pensar en lo obvio la empresa o instituciones que utilicen el producto seria vulnerable o me equivoco.<br><br>

Departamento de Estado EE.UU — Vulnerable.<br><br>

<center><img src="https://miro.medium.com/max/1400/1*upOhak_3tX1Dan7ZbSTmoQ.png" width="600px"></center><br><br>

Armada de EE.UU — Vulnerable.<br><br>

<center><img src="https://miro.medium.com/max/1400/1*FxPYrjNv-bmE7A3epGb7-w.png" width="600px"></center>

                      <br><br>
                      Description:<br>
                      <a href="http://help.serena.com/doc_center/sbm/ver11_4_2/sbm_release_notes.htm" target="_blank" style="color: aliceblue">http://help.serena.com/doc_center/sbm/ver11_4_2/sbm_release_notes.htm</a><br>
                      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3477" target="_blank" style="color: aliceblue">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3477</a>
                      <br><br>
                    </p>
        					</td>
              	</tr>
            </table>
          </p>
        </div>
      </div>
  </div>
</div>

<!--<div class="container py-5">
  <h4>Thanks</h4>
    <a href="https://github.com/s1kr10s">https://github.com/s1kr10s</a></p>
  
</div>-->

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  </body>
</html>
